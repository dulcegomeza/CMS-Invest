angular.module("inspinia").controller("Noticias",["$rootScope","$scope","$state","$http","$stateParams","SweetAlert","DTOptionsBuilder","DTColumnDefBuilder",function(t,o,a,n,e,i,s,r){o.dtOptions=s.newOptions().withOption("bFilter",!1).withOption("order",[0,"desc"]).withLanguage({sProcessing:"Procesando...",sLengthMenu:"Mostrar _MENU_ registros",sZeroRecords:"No se encontraron resultados",sEmptyTable:"Ningún dato disponible en esta tabla",sInfo:"Mostrando registros del _START_ al _END_ de un total de _TOTAL_ registros",sInfoEmpty:"Mostrando registros del 0 al 0 de un total de 0 registros",sInfoFiltered:"(filtrado de un total de _MAX_ registros)",sInfoPostFix:"",sSearch:"Buscar:",sUrl:"",sInfoThousands:",",sLoadingRecords:"Cargando...",oPaginate:{sFirst:"Primero",sLast:"Último",sNext:"Siguiente",sPrevious:"Anterior"},oAria:{sSortAscending:": Activar para ordenar la columna de manera ascendente",sSortDescending:": Activar para ordenar la columna de manera descendente"}}),o.DTColumnDefs=[r.newColumnDef(3).notSortable()],o.loading=!0,n.get("php/noticias.php").success(function(t){o.noticias=t,o.loading=!1}),o.activar=function(t){i.swal({title:"AVISO",text:"¿Estas seguro de activar la noticia?",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Si",cancelButtonText:"NO",closeOnConfirm:!0,closeOnCancel:!0},function(o){o&&n.get("php/noticias_activar.php?idnoticia="+t).success(function(t){a.go(a.current,{},{reload:!0})})})},o.desactivar=function(t){i.swal({title:"AVISO",text:"¿Estas seguro de activar la noticia?",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Si",cancelButtonText:"NO",closeOnConfirm:!0,closeOnCancel:!0},function(o){o&&n.get("php/noticias_desactivar.php?idnoticia="+t).success(function(t){a.go(a.current,{},{reload:!0})})})}}]).controller("NoticiaNueva",["$rootScope","$scope","$http","$stateParams","SweetAlert","$state","Upload",function(t,o,a,n,e,i,s){var r=new Date;o.agregando=!1,n.idnoticia?(o.loading=!0,a.get("php/noticia.php?idnoticia="+n.idnoticia).success(function(a){o.forma=a,o.forma.idusuario=t.datos.idusuario})):o.forma={idnoticia:0,idusuario:t.datos.idusuario,titulo:"",contenido:"",fecha_noticia:r,activo:!1,imagenes:[],rutas:[]},o.agregar=function(){o.agregando=!0,o.forma.fecha_noticia=moment(o.forma.fecha_noticia).toDate(),s.upload({url:"php/noticias_agregar.php",data:o.forma,method:"POST"}).then(function(t){console.log(t.data),o.agregando=!1,t.data.status&&i.go("noticias.index")},function(t){console.log("Error status: "+t.status),o.agregando=!1})},o.eliminarImg=function(t){a.get("php/noticias_imagenes_eliminar.php?idnoticia_imagen="+t).success(function(t){t.status&&i.go(i.current,{},{reload:!0})})}}]);